{{ define "main" }}

<!-- ðŸ¡ Home Section (Merged Hero + About) -->
<section id="home" class="hero">
  <div class="container">
    <div class="hero-content">
      <h1>Welcome to Capulong Farms - Halal Division</h1>
      <p>Halal certified fresh produce and farm supplies delivered from our farm to your table</p>
    </div>

    <div class="about-content" style="margin-top: 3rem;">
      <div class="about-image">
        <img src="/images/halal-photo.jpg" alt="Capulong Farms Halal Division">
      </div>

      <div class="about-text">
        <p style="color: white;">Capulong Farms Halal Division is a family-owned certified halal business.</p>
        <p style="color: white;"><i class="fas fa-map-marker-alt"></i> Located in Lanang Candaba Pampanga Philippines.</p>
        <p style="color: white;">We believe in sustainable farming practices with Islamic compliance.</p>
        <p style="color: white;">Our commitment is halal certification, quality, freshness and supporting local Islamic agriculture.</p>
      </div>
      
      <!-- Google Map -->
      <div class="map-container" style="margin-top: 2rem;">
        <div class="map-wrapper">
          <iframe 
            src="https://www.google.com/maps/embed?pb=!1m17!1m12!1m3!1d3858.234567!2d120.8118167!3d15.1142611!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m2!1m1!2zMTXCsDA2JzUxLjM0Ik4gMTIwwrA0OCc0Mi41NCJF!5e0!3m2!1sen!2sph!4v1699876543210&q=15.1142611,120.8118167(Capulong+Farms)"
            width="100%" 
            height="250" 
            style="border:0; border-radius: 8px;" 
            allowfullscreen="" 
            loading="lazy" 
            referrerpolicy="no-referrer-when-downgrade"
            title="Capulong Farms - Exact Location (15Â°6'51.34&quot;N 120Â°48'42.54&quot;E)">
          </iframe>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- ðŸ’³ Buy & Pay Section -->
<section id="order" class="contact-section">
  <div class="container">
    <h2>Buy & Pay</h2>
    <div class="contact-grid">
      <div class="contact-info">
        <h3>How to Order</h3>
        <p>Click the Product photo to add in the Cart or adjust order quantity in the Add to Cart section on each product, and press the Cart trolley button to review your order and press Proceed to Buy button, we'll confirm availability and arrange for delivery.</p>
        <div class="contact-details">
          <p>
            <a href="https://wa.me/{{ .Site.Params.whatsapp_number }}" class="whatsapp-contact-link">
              <i class="fab fa-whatsapp"></i> WhatsApp Business
            </a>
          </p>
          <p>
            <a href="https://m.me/61582708015159" class="messenger-contact-link">
              <i class="fab fa-facebook-messenger"></i> Messenger
            </a>
          </p>
          <p>
            <a href="https://www.facebook.com/share/1A1hf1n4rs/" class="facebook-contact-link" target="_blank">
              <i class="fab fa-facebook"></i> Facebook
            </a>
          </p>
        </div>
      </div>
      <div class="payment-info">
        <h3>Payment via GCash</h3>
        <p>Scan the QR code below to pay via GCash:</p>
        <div class="gcash-qr">
          <img src="{{ .Site.Params.gcash_qr_image }}" alt="GCash QR Code">
        </div>
      </div>
    </div>
  </div>
</section>

<!-- ðŸ§º Products Section with Tabs -->
<section id="products" class="products-section">
  <div class="container">
    <h2>Products & Prices</h2>

    <!-- Tabs Navigation -->
    <div class="tabs">
      {{ range $index, $category := .Site.Data.products.categories }}
        <button class="tab-button {{ if eq $index 0 }}active{{ end }}" data-tab="tab-{{ $index }}"{{ if $category.external_link }} data-external-link="{{ $category.external_link }}"{{ end }}>{{ $category.name }}</button>
      {{ end }}
    </div>

    <!-- Tabs Content -->
    {{ range $index, $category := .Site.Data.products.categories }}
    <div id="tab-{{ $index }}" class="tab-content {{ if eq $index 0 }}active{{ end }}">
      {{ if $category.external_link }}
        <div class="external-link-message">
          <p>Click the "{{ $category.name }}" tab above to visit <strong>{{ $category.external_link }}</strong> and explore our complete product range!</p>
        </div>
      {{ else }}
      <div class="products-grid">
        {{ range $category.products }}
        {{ if not .discontinue }}
        <div class="product-card {{ if not .available }}not-available{{ end }}" data-product-name="{{ .name }}" data-product-price="{{ .price }}" data-product-discount="{{ .discount }}">
          <div class="product-image">
            {{ if .available }}
              <a href="javascript:void(0);" onclick="orderProduct('{{ .name }}', '{{ .price }}', {{ .discount }})" style="display:block; position: relative;">
                <img src="{{ .image | relURL }}" alt="{{ .name }}" loading="lazy" onerror="this.src='/images/placeholder.png'">
                <div class="available-icon">âœ”</div>
                {{ if and .discount (gt .discount 0) }}
                  {{ if eq .discount 100 }}
                    <div class="discount-watermark">FREE</div>
                  {{ else }}
                    <div class="discount-watermark">
                      <span class="discount-percentage">{{ .discount }}%</span>
                      <span class="discount-text">discount</span>
                    </div>
                  {{ end }}
                {{ end }}
              </a>
            {{ else }}
              <img src="{{ .image | relURL }}" alt="{{ .name }}" loading="lazy" onerror="this.src='/images/placeholder.png'">
              <div class="watermark">NOT AVAILABLE</div>
              <div class="not-available-icon">âœ–</div>
            {{ end }}
          </div>
          <h4>{{ .name }}</h4>
          <p class="price">{{ .price }}</p>
          {{ if .available }}
          <div class="quantity-container">
            <label class="quantity-label">Quantity:</label>
            <div class="quantity-controls">
              <button class="qty-btn minus-btn" onclick="changeQuantity('{{ .name | urlize }}', -1)">-</button>
              <input type="number" class="qty-input" id="qty-{{ .name | urlize }}" value="1" min="1" max="9999" onchange="validateQuantity('{{ .name | urlize }}')" oninput="validateQuantityInput('{{ .name | urlize }}')" onkeypress="return isNumberKey(event)">
              <button class="qty-btn plus-btn" onclick="changeQuantity('{{ .name | urlize }}', 1)">+</button>
            </div>
          </div>
          <div style="display: flex; gap: 0.5rem; margin-top: 0.5rem;">
            <button class="add-to-cart-btn" onclick="addToCartWithQuantity('{{ .name }}', '{{ .price }}', '{{ .name | urlize }}', {{ .discount }})">
              <i class="fas fa-shopping-cart"></i> Add to Cart
            </button>
          </div>
          {{ end }}
        </div>
        {{ end }}
        {{ end }}
      </div>
      {{ end }}
    </div>
    {{ end }}
  </div>

  <!-- All JavaScript functionality has been moved to external files: cart.js and app.js -->
</section>

<!-- ðŸ›’ Cart Modal -->
<div id="cart-modal" class="cart-modal">
  <div class="cart-modal-content">
    <div class="cart-modal-header">
      <h2><i class="fas fa-shopping-cart"></i> Your Cart</h2>
      <button class="cart-modal-close" onclick="closeCartModal()">&times;</button>
    </div>
    <div class="cart-modal-body">
      <div id="cart-items" class="cart-items">
        <!-- Cart items will be populated here -->
      </div>
      <div id="cart-empty" class="cart-empty" style="display: none;">
        <i class="fas fa-shopping-cart"></i>
        <p>Your cart is empty</p>
        <p>Browse our products and add items to your cart</p>
      </div>
    </div>
    <div class="cart-modal-footer">
      <div class="cart-total">
        <h3 id="cart-total-amount">Total: â‚±0.00</h3>
      </div>
      <div class="cart-actions-modal">
        <button class="cart-btn cart-btn-secondary" onclick="clearCart()">
          <i class="fas fa-trash"></i> Clear Cart
        </button>
        <button class="cart-btn cart-btn-primary" onclick="proceedToBuy()">
          <i class="fas fa-credit-card"></i> Proceed to Buy
        </button>
      </div>
    </div>
  </div>
</div>

{{ end }}
